 {% extends 'base.html' %} {% block content %}
    

    <div id="barChart"></div>
    <div id="difficultyChart"></div>

    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>-->
    <!--<script type="text/javascript" src="static/js/graph.js"></script>-->

<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/dc/1.6.0/dc.css"></script>-->
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/crossfilter/1.3.12/crossfilter.min.js"></script>-->

<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/dc/2.2.0/dc.min.js"></script>-->
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/dc/2.2.0/dc.min.js.map"></script>-->

    <script type="text/javascript" src="static/js/d3.min.js"></script>
    <script type="text/javascript" src="static/js/crossfilter.min.js"></script>
    <script type="text/javascript" src="static/js/dc.min.js"></script>
    <script type="text/javascript" src="static/js/queue.min.js"></script>
    <script>


function getParsedData(){
 let stringData = "{{ imported_data|safe }}";
// below line of code from: https://stackoverflow.com/questions/16450250/javascript-replace-single-quote-with-double-quote
// changes singe quotes to double quotes
//required to parse data
let stringDataWithDoubleQuotes = stringData.replace(/'/g, '"');
let data = JSON.parse(stringDataWithDoubleQuotes);
var ndx = crossfilter(data); 
return ndx;
}

ndx = getParsedData()

function showTopNames(ndx){
var chart= dc.rowChart("#barChart")
let dim = ndx.dimension(dc.pluck("Name"));

let group = dim.group();

//https://stackoverflow.com/questions/29916853/how-to-display-a-graph-of-top-n-items
var topTenNames = (function (group) {return {
  all:function () {
    return group.top(10).filter(function(d) {
      return d.key != "Not mentioned";
     });
  }
};})(group);
//https://github.com/dc-js/dc.js/blob/master/web/examples/row.html
chart
    .width(768)
    .height(480)
    .x(d3.scale.ordinal())
    // .xUnits(dc.units.ordinal)
    .elasticX(true)
    .dimension(dim)
    .group(topTenNames)
    // .xAxisLabel("Count")
    // .yAxisLabel("Recipe")
    .render();

chart.ordering(function(d) { return -d.value; });

}

showTopNames(ndx)

function showDifficultyChart(ndx){
    
    let chart = dc.pieChart("#difficultyChart")
let dim = ndx.dimension(dc.pluck("Difficulty"));

let group = dim.group();

//https://github.com/dc-js/dc.js/blob/master/web/examples/pie.html
 chart
    .width(768)
    .height(480)
    .slicesCap(4)
    .innerRadius(100)
    .dimension(dim)
    .group(group)
    .legend(dc.legend())
  chart.render();

};

showDifficultyChart(ndx)




    </script>
    

{% endblock %}